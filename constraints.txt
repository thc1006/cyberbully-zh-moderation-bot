# CyberPuppy Global Constraints
# This file pins all transitive dependencies for reproducible builds
# Generated by: make deps-constraints
# Last updated: 2025-09-24

# Critical Security & Compatibility Constraints
urllib3>=2.0.0,<3.0.0  # Security updates, modern HTTP/2 support
certifi>=2023.7.22     # Latest CA bundle for security
cryptography>=41.0.0   # Critical security patches
PyJWT>=2.8.0          # Security fixes for JWT handling

# Python Version Compatibility
setuptools>=68.0.0     # Python 3.12+ compatibility
wheel>=0.41.0          # Modern wheel format support
pip>=23.3.0            # pip-tools compatibility

# Core Framework Stability
pydantic>=2.5.0,<3.0.0              # V2 API stability
fastapi>=0.104.0,<1.0.0             # API stability
starlette>=0.27.0,<1.0.0            # ASGI compatibility
uvicorn>=0.24.0,<1.0.0              # ASGI server compatibility

# ML/AI Stack Compatibility - Windows Compatible
# Use CPU-only or CUDA pre-built wheels on Windows to avoid compilation
torch>=2.1.0,<3.0.0                 # PyTorch ecosystem stability
# Windows-specific: Prefer index-url with pre-compiled wheels
--find-links https://download.pytorch.org/whl/cpu/torch_stable.html; platform_system == "Windows"
transformers>=4.35.0,<5.0.0         # HuggingFace compatibility
tokenizers>=0.15.0,<1.0.0           # Fast tokenization
datasets>=2.14.0,<3.0.0             # HuggingFace datasets
scikit-learn>=1.3.0,<2.0.0          # Sklearn API stability

# Data Processing Stack - Windows Compatible
# Use pre-compiled wheels to avoid GCC compilation issues on Windows
numpy>=1.24.4,<2.0.0; python_version < "3.12" and platform_system != "Windows"
numpy>=1.26.2,<2.0.0; python_version >= "3.12" and platform_system != "Windows"
# Windows-specific: Use latest stable pre-compiled wheels
numpy>=1.24.4,<2.0.0; python_version < "3.12" and platform_system == "Windows"
numpy>=1.26.2,<2.0.0; python_version >= "3.12" and platform_system == "Windows"
pandas>=2.1.0,<3.0.0                # Pandas 2.x API stability
pyarrow>=14.0.0,<16.0.0             # Arrow format compatibility

# Testing Framework Constraints
pytest>=7.4.0,<8.0.0                # Pytest 7.x stability
pytest-cov>=4.1.0,<5.0.0            # Coverage plugin compatibility
pytest-asyncio>=0.21.0,<1.0.0       # Async testing support

# Development Tool Constraints
black>=23.12.0,<25.0.0              # Code formatting stability
ruff>=0.1.0,<1.0.0                  # Linting tool compatibility
mypy>=1.7.0,<2.0.0                  # Type checking stability

# Documentation & Jupyter
jupyter-core>=5.0.0,<6.0.0          # Jupyter ecosystem compatibility
notebook>=7.0.0,<8.0.0              # Notebook interface stability
jupyterlab>=4.0.0,<5.0.0            # JupyterLab compatibility

# Chinese NLP Specific - Windows Compatible
jieba>=0.42.1,<1.0.0                # Chinese word segmentation
# Use reimplemented version on Windows to avoid OpenCC C++ compilation issues
opencc-python-reimplemented>=0.1.7,<1.0.0  # Traditional/Simplified conversion (Windows compatible)

# Explainability Tools
captum>=0.7.0,<1.0.0                # PyTorch interpretability
shap>=0.44.0,<1.0.0                 # SHAP explanations

# Bot & API Constraints
line-bot-sdk>=3.5.0,<4.0.0          # LINE Bot API compatibility
requests>=2.31.0,<3.0.0             # HTTP client stability
python-dotenv>=1.0.0,<2.0.0         # Environment variable management

# Async & Concurrency
asyncio-extras>=1.3.0               # Extended asyncio utilities
aiofiles>=23.0.0,<24.0.0           # Async file operations

# Security & Validation
bandit>=1.7.0,<2.0.0               # Security linting
safety>=3.0.0,<4.0.0               # Dependency vulnerability scanning

# Utility Constraints
rich>=13.7.0,<14.0.0               # Terminal formatting
tqdm>=4.66.0,<5.0.0                # Progress bars
click>=8.1.0,<9.0.0                # CLI framework
pyyaml>=6.0.1,<7.0.0               # YAML parsing
loguru>=0.7.2,<1.0.0               # Structured logging

# Build & Packaging - Windows Compatible
build>=1.0.0,<2.0.0                # PEP 517 build tool
twine>=4.0.0,<5.0.0                # PyPI upload tool

# Windows-specific constraints to avoid compilation issues
# Force use of pre-compiled wheels for packages that commonly fail on Windows
--only-binary=numpy,scipy,pandas,scikit-learn,matplotlib,Pillow,lxml; platform_system == "Windows"

# Performance & Profiling
memory-profiler>=0.61.0,<1.0.0     # Memory usage profiling
line-profiler>=4.1.0,<5.0.0        # Line-by-line profiling
py-spy>=0.3.14,<1.0.0              # Python profiler

# Multi-environment Testing
tox>=4.11.0,<5.0.0                 # Testing across environments
nox>=2023.4.0,<2024.0.0            # Task automation